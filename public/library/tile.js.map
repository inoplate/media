{"version":3,"sources":["tile.coffee"],"names":[],"mappings":"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","file":"tile.js","sourcesContent":["class LibraryTile\n    constructor: (@$element, options) ->\n        @$markup = options.markup || @__getDefaultMarkup()\n        @$uploadingMarkup = options.uploadingMarkup || @__getDefaultUploadingMarkup()\n        @payloads = options.payloads || {}\n        @endInfo = options.endInfo || '.end-info'\n        @thumbnail = options.thumbnail\n        @multiple = options.multiple || false\n        @wrapper = options.holder || 'ul'\n        @holder = options.holder || 'li'\n        @nextLoader = options.nextLoader || '.next-libraries-loader'\n        @$nextLoader = $ @nextLoader, @$element\n\n        @__attachEventToHolder @holder\n\n        @$element.append '<div class=\"overlay hide\"></div>'\n\n        @$element.slimScroll\n                height: options.height || '450px'\n            .bind 'slimscrolling', (e, pos) =>\n                @checkPagination()\n\n        $ window\n            .scroll () =>\n                @checkPagination()\n\n        $ \".slimScrollBar\"\n            .hide()\n\n    setPayload: (payloads) ->\n        @payloads = payloads\n\n    setMultiple: (multiple) ->\n        @multiple = multiple\n\n    setMarkup: (markup) ->\n        @$markup = $ markup\n\n    getMarkup: () ->\n        return @$markup\n\n    setUploadingMarkup: (markup) ->\n        @$uploadingMarkup = $ markup\n\n    getUploadingMarkup: () ->\n        return @$uploadingMarkup\n\n    addUploading: (identifier, caption) ->\n        $markup = @__buildUploadingMarkup identifier, caption\n        $ \"#{@wrapper}\", @$element\n            .prepend $markup\n\n    setProgress: (identifier, progress) ->\n        $li = $ \"#{@holder}[data-upload-id=\\\"#{identifier}\\\"]\", @$element\n        img = this.__getUploadingHolder \"(#{progress})Uploading..\"\n        $ '.img-placeholder', $li\n            .html img\n\n        $img = $ 'img', $li\n\n        Holder.run\n            images: $img[0]\n\n    retryUpload: (identifier) ->\n        $li = $ \"#{@holder}[data-upload-id=\\\"#{identifier}\\\"]\", @$element\n        $li.removeClass 'error'\n        $li.addClass 'uploading'\n\n    markAsError: (identifier, message) ->\n        $li = $ \"#{@holder}[data-upload-id=\\\"#{identifier}\\\"]\", @$element\n        img = this.__getUploadingHolder \"Error\"\n        $img = $ 'img', $li\n\n        $img.attr\n            'data-src': img\n        \n        Holder.run\n            images: $img[0]\n\n        $li.removeClass 'uploading'\n            .addClass 'error'\n\n        $li.data 'errorMessage', message\n\n    markAsSuccess: (identifier, data) ->\n        thumbnail = this.__getThumbnail data\n        $li = $ \"#{@holder}[data-upload-id=\\\"#{identifier}\\\"]\", @$element\n        $li.removeClass 'uploading'\n        $li.data 'meta', data\n        $li.attr 'id', \"library-#{data.id}\"\n        $img = $ \"img\", $li\n\n        $img.prop 'src', thumbnail\n\n    remove: (identifier) ->\n        $li = $ \"#{@holder}[data-upload-id=\\\"#{identifier}\\\"]\", @$element\n        $li.remove()\n\n    refineSearch: (url, payloads = {}) ->\n        $ '.overlay', @$element\n            .removeClass 'hide'\n\n        @$element.trigger \"media.library.tile.refining-search\"\n\n        @__loadMore url, payloads, () =>\n            $ \"#{@holder}:not(#{@nextLoader})\", @$element\n                .remove()\n\n            $ '.overlay', @$element\n                .addClass 'hide'\n\n            @$element.trigger \"media.library.tile.refined-search\"\n\n    checkPagination: () ->\n        if @$nextLoader.is(':within-viewport') && !@$nextLoader.data('loading')\n            url = $ 'a', @$nextLoader\n                    .prop 'href'\n\n            @__loadMore url\n\n    clearSelection: () ->\n        $ @holder, @$element\n            .removeClass \"selected\"\n\n    __getUploadingHolder: (text) ->\n        \"<img data-src=\\\"holder.js/149x149?auto=yes&bg=ecf0f5&text=#{text}\\\" />\"\n\n    __loadMore: (url, payloads = {}, callback) ->\n        payloads = this.__normalizePayloads payloads\n        url = \"#{url}#{payloads}\"\n        items = []\n        @$element.trigger \"media.library.tile.loading\"\n        @$nextLoader.data 'loading', true\n\n        $.get url, (result) =>\n            if typeof callback == 'function'\n                callback.apply this\n\n            @$nextLoader.before this.__buildMarkup item for item in result.libraries.data\n\n            if result.libraries.next_page_url\n                $ 'a', @$nextLoader\n                    .prop 'href', result.libraries.next_page_url\n\n                @$nextLoader\n                    .data 'loading', false\n\n                $ @endInfo, @$element\n                    .addClass 'hide'\n\n                @checkPagination()\n            else\n                @$nextLoader\n                    .addClass 'hide'\n\n                $ @endInfo, @$element\n                    .removeClass 'hide'\n\n            @$element.trigger \"media.library.tile.loaded\"\n        ,\n            'json'\n\n    __normalizePayloads: (payloads) ->\n        globalPayloads = @payloads\n\n        if typeof payloads == 'function'\n            payloads = payloads.apply this\n\n        if typeof @payloads == 'function'\n            globalPayloads = @payloads.apply this\n\n        payloads = $.extend globalPayloads, payloads, true\n        payloads = this.__stringifyPayload payloads\n\n        payloads\n\n    __getThumbnail: (library) ->\n        if typeof @thumbnail == 'function'\n            @thumbnail.apply this, [library]\n        else\n            @thumbnail\n\n    __getDefaultUploadingMarkup: () ->\n        $ \"<li class=\\\"uploading\\\" >\n                <a class=\\\"thumbnail\\\">\n                    <div class=\\\"img-placeholder\\\"></div>\n                    <div class=\\\"caption\\\"></div>\n                    <div class=\\\"btn-action-wrapper\\\">\n                        <div class=\\\"btn-action\\\">\n                            <span class=\\\"fa-stack fa-lg btn-resume hide\\\">\n                                <i class=\\\"fa fa-circle fa-stack-2x\\\"></i>\n                                <i class=\\\"fa fa-repeat fa-stack-1x fa-inverse\\\"></i>\n                            </span>\n                            <span class=\\\"fa-stack fa-lg btn-pause\\\">\n                                <i class=\\\"fa fa-circle fa-stack-2x\\\"></i>\n                                <i class=\\\"fa fa-pause fa-stack-1x fa-inverse\\\"></i>\n                            </span>\n                            <span class=\\\"fa-stack fa-lg btn-cancel\\\">\n                                <i class=\\\"fa fa-circle fa-stack-2x\\\"></i>\n                                <i class=\\\"fa fa-times fa-stack-1x fa-inverse\\\"></i>\n                            </span>\n                        </div>\n                    </div>\n                </a>\n              </li>\"\n\n    __getDefaultMarkup: () ->\n         $ \"<li>\n                <a class=\\\"thumbnail\\\">\n                    <div class=\\\"img-placeholder\\\">\n                        <img />\n                    </div>\n                    <div class=\\\"caption\\\"></div>\n                </a>\n            </li>\"\n\n    __buildUploadingMarkup: (identifier, caption) ->\n        img = @__getUploadingHolder 'Uploading...'\n        $markup = @getUploadingMarkup().clone()\n\n        if $markup instanceof $\n            $markup\n                .attr \"data-upload-id\", \"#{identifier}\"\n\n            $ '.img-placeholder', $markup\n                .html img\n\n            $ '.caption', $markup\n                .text caption\n\n            $img = $ 'img', $markup\n\n            Holder.run\n                images: $img[0]\n\n        else if typeof $markup == 'function'\n            $markup = $markup.apply this, [identifier, caption]\n\n        $markup\n\n    __buildMarkup: (data) ->\n        thumbnail = @__getThumbnail data\n        $markup = @getMarkup().clone()\n\n        if $markup instanceof $\n            $markup\n                .attr \"id\", \"library-#{data.id}\"\n                .data \"meta\", data\n\n            $ 'img', $markup\n                .prop 'src', thumbnail\n                .prop 'alt', data.description.title\n\n            $ '.caption', $markup\n                .text data.description.title\n        else if typeof $markup == 'function'\n            $markup = $markup.apply this, [data]\n\n        $markup\n\n    __attachEventToHolder: (holder) ->\n        @$element\n            .on 'click', \"#{@nextLoader} a\", (e) =>\n                false\n\n        @$element\n            .on 'click', holder, (e) =>\n                context = $ e.currentTarget\n                target = $ e.target\n\n                actionButtons = target.parents '.btn-action'\n                isUploading = context.hasClass('uploading')\n\n                if isUploading || actionButtons.length\n                    return\n\n                if !@multiple\n                    $ holder, @$element\n                        .removeClass \"selected\"\n\n                context.toggleClass \"selected\"\n                meta = context.data \"meta\"\n                error = context.data 'error-message'\n\n                if typeof meta == 'string'\n                    meta = JSON.parse meta\n\n                if typeof error == 'string'\n                    error = JSON.parse error\n\n                if  context.hasClass 'selected'\n                    context.trigger \"media.library.tile.selected\", [meta, error]\n                else\n                    context.trigger \"media.library.tile.unselected\", [meta, error]\n\n    __stringifyPayload: (payloads) ->\n        string = \"\"\n\n        for k,v of payloads\n            string = \"#{string}&#{k}=#{v}\"\n\n        string\n\n\n# PLUGIN DEFINITION\n# ============================\n\n$.fn.libraryTile = (option) ->\n    args = arguments\n    defaults = \n        height: \"450px\"\n\n    this.each () ->\n        $this = $ this\n        data = $this.data('library.tile')\n        options = $.extend {}, defaults, $this.data(), typeof option == 'object' && option\n        if !data \n            $this.data 'library.tile', (data = new LibraryTile $this, options)\n\n        if typeof option == 'string'\n            argsToSent = []\n\n            for k,v of args\n                if k > 0\n                    argsToSent.push v\n\n            data[option].apply(data, argsToSent)\n\n    this"],"sourceRoot":"/source/"}