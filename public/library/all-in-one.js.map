{"version":3,"sources":["all-in-one.coffee"],"names":[],"mappings":"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","file":"all-in-one.js","sourcesContent":["openMediaDetail = getLocalStorage 'inoplate.media.open-media-detail'\n\nuserFormatRepo = (repo) ->\n  if (repo.loading) \n    return repo.text;\n\n  markup = \"<div class='select2-result-repository clearfix'>\n                <div class='select2-result-repository__meta'>\n                  <div class='select2-result-repository__title'>#{repo.name}</div>\n                </div>\n            </div>\";\n\n  return markup;\n\nuserFormatRepoSelection = (repo) ->\n  return repo.name||repo.text;\n\n$ '#library-update-form'\n    .modal\n        show: false\n\nsharingForm = $ \"select[name='users']\", '#sharing-form'\n                .select2\n                    ajax:\n                        url: () ->\n                            source = $ \"select[name=\\\"users\\\"]\", \"#sharing-form\"\n                                        .data \"source\"\n\n                            source\n                        ,\n                        dataType: 'json'\n                        ,\n                        delay: 250\n                        ,\n                        data: (params) ->\n                            param =\n                                search: params.term\n                                page: params.page\n\n                            param\n                        ,\n                        processResults: (data, params) ->\n                            params.page = params.page || 1;\n\n                            results = \n                                results: data.data\n                                pagination:\n                                    more: (params.page * 5) < data.total\n\n                            results\n                        ,\n                    escapeMarkup: (markup) -> \n                        return markup\n                        \n                    minimumInputLength: 1\n                    templateResult: userFormatRepo\n                    templateSelection: userFormatRepoSelection\n\nsharingTable = $ '#shared-to-table'\n                    .DataTable\n                        dom: '<\"row\"<\"col-sm-6\"l><\"col-sm-6\"f>><\"row\"<\"col-sm-12\"rt>><\"row\"<\"col-sm-5\"i><\"col-sm-7\"p>>'\n                        serverSide: false\n                        ajax: false\n                        createdRow: (row, data, index) ->\n                            true\n                        columnDefs: [\n                            visible: false\n                            targets: 0\n                        ,\n                            orderable: false\n                            targets: 2\n                            render: (data, type, full, meta) ->\n                                '<button class=\"btn btn-danger remove-share btn-sm pull-right\">\n                                    <i class=\"fa fa-trash\"></i>\n                                </button>'\n                        ]\n\n$ '#shared-to-table'\n    .on 'click', '.remove-share', () ->\n        tr = $ this\n                .parents 'tr'\n\n        sharingTable.row tr\n                    .remove()\n                    .draw()\n\nsharingForm.on 'select2:select', () ->\n    $this = $ this\n    data = $this.select2 'data'\n\n    sharingTable.row.add [ data[0].id, data[0].name, null ]\n                    .draw()\n\n    $this.val null\n         .trigger 'change'\n\nif openMediaDetail == 'close'\n    $ \".media-detail\"\n        .css 'display', 'none'\n\n    $ \"i\", '#toggle-media-detail'\n        .removeClass \"fa-toggle-on\"\n        .addClass \"fa-toggle-off\"\n\ntile =  $ '.media-container'\n            .libraryTile\n                height: \"450px\"\n                thumbnail: (library) ->\n                    getThumbnail(library.description.mime) || \"/uploads/#{library.description.path}/thumb\"\n\ndetail = $ '.media-detail'\n            .libraryDetail\n                thumbnail: (identifier, path, mime) ->\n                    getThumbnail(mime) || \"/uploads/#{path}/mini-display\"\n                largePreview: (identifier, path, mime) ->\n                    \"uploads/#{path}/mini-display\"\n\ntile.libraryTile 'checkPagination'\n\n$ '.btn-refresh'\n    .click () ->\n        ownership = $ 'select[name=\"ownership\"]'\n                    .val()\n\n        visibility = $ 'select[name=\"visibility\"]'\n                        .val()\n\n        search = $ 'input[name=\"search\"]'\n                    .val()\n\n        $ \"#btn-share\"\n            .addClass 'disabled'\n\n        $ \"#btn-update\"\n            .addClass 'disabled'\n\n        payloads = \n            ownership: ownership\n            visibility: visibility\n            search: search\n\n        tile.libraryTile 'setPayload', payloads\n        tile.libraryTile 'refineSearch', \"/admin/inoplate-media/libraries?page=1\"\n        detail.libraryDetail 'clearDetail'\n\n$ \"#upload-new\"\n    .click () ->\n        $ '.uploader-container'\n            .toggleClass \"hide\"\n\n$ \"#toggle-media-detail\"\n    .click () ->\n        $ \".media-detail\"\n            .slideToggle 0, ()->\n                state = $ this\n                            .css 'display'\n\n                if state == 'none'\n                    setLocalStorage 'inoplate.media.open-media-detail', 'close'\n                else\n                    setLocalStorage 'inoplate.media.open-media-detail', 'open'\n\n                tile.libraryTile 'checkPagination'\n\n        $ \"i\", this\n            .toggleClass \"fa-toggle-on fa-toggle-off\"\n\n$ \".uploader-dismiss\"\n    .click () ->\n        $ this\n            .parents \".uploader-container\"\n                .addClass \"hide\"\n\n$ '.uploader'\n    .on 'uploader.fileAdded', (e, file) ->\n        identifier = file.uniqueIdentifier\n        tile.libraryTile 'addUploading', identifier, file.name\n\n        $ \"[data-upload-id=\\\"#{identifier}\\\"]\", tile\n            .data 'file', file\n\n$ '.uploader'\n    .on 'uploader.fileProgress', (e, file) ->\n        identifier = file.uniqueIdentifier\n        progress = file.progress() * 100\n        tile.libraryTile 'setProgress', identifier, \"#{progress.toFixed(2)}%25\"\n\n$ '.uploader'\n    .on 'uploader.fileRetry', (e, file, chunk) ->\n        identifier = file.uniqueIdentifier\n        tile.libraryTile 'retryUpload', identifier\n\n$ '.uploader'\n    .on 'uploader.fileError', (e, file, message, chunk) ->\n        identifier = file.uniqueIdentifier\n        tile.libraryTile 'markAsError', identifier, message\n        $ \"[data-upload-id=\\\"#{identifier}\\\"] .btn-pause\", tile\n            .addClass 'hide'\n\n        $ \"[data-upload-id=\\\"#{identifier}\\\"] .btn-resume\", tile\n            .removeClass 'hide'\n\n$ '.uploader'\n    .on 'uploader.fileSuccess', (e, file, result) ->\n        identifier = file.uniqueIdentifier\n        result = JSON.parse result\n        tile.libraryTile 'markAsSuccess', identifier, result.library\n\ntile.on 'click', 'li.uploading .btn-resume', () ->\n    $this = $ this\n    $li = $this.parents 'li'\n    identifier = $li.data 'uploadId'\n    $file = $li.data 'file'\n\n    $ \"[data-upload-id=\\\"#{identifier}\\\"] .btn-pause\", tile\n        .removeClass 'hide'\n\n    $ \"[data-upload-id=\\\"#{identifier}\\\"] .btn-resume\", tile\n        .addClass 'hide'\n\n    $file.resume()\n\ntile.on 'click', 'li.uploading .btn-pause', () ->\n    $this = $ this\n    $li = $this.parents 'li'\n    identifier = $li.data 'uploadId'\n    $file = $li.data 'file'\n\n    $ \"[data-upload-id=\\\"#{identifier}\\\"] .btn-pause\", tile\n        .addClass 'hide'\n\n    $ \"[data-upload-id=\\\"#{identifier}\\\"] .btn-resume\", tile\n        .removeClass 'hide'\n\n    $file.pause()\n\ntile.on 'click', 'li.error .btn-resume', () ->\n    $this = $ this\n    $li = $this.parents 'li'\n    identifier = $li.data 'uploadId'\n\n    $li.addClass 'uploading'\n       .removeClass 'error'\n       .removeClass 'selected'\n\n    $ \"[data-upload-id=\\\"#{identifier}\\\"] .btn-pause\", tile\n        .removeClass 'hide'\n\n    $ \"[data-upload-id=\\\"#{identifier}\\\"] .btn-cancel\", tile\n        .removeClass 'hide'\n\n    $ \"[data-upload-id=\\\"#{identifier}\\\"] .btn-resume\", tile\n        .addClass 'hide'\n\n    $file = $li.data 'file'\n    $file.retry()\n\ntile.on 'click', 'li.uploading .btn-cancel, li.error .btn-cancel', () ->\n    $this = $ this\n    $li = $this.parents 'li'\n    $file = $li.data 'file'\n    identifier = $li.data 'uploadId'\n\n    $file.cancel()\n    tile.libraryTile 'remove', identifier\n\n    if $li.hasClass 'selected'\n        detail.libraryDetail 'hideError'\n        detail.libraryDetail 'clearDetail'\n\ntile.on 'media.library.tile.loading', (e) ->\n    $ '.btn-refresh'\n        .button 'loading'\n\ntile.on 'media.library.tile.loaded', (e) ->\n    $ '.btn-refresh'\n        .button 'reset'\n\ntile.on 'media.library.tile.selected', 'li', (e, meta, error) ->\n    if(typeof error == 'undefined')\n        detail.libraryDetail 'showDetail', meta.id, meta.description.path, meta.description.mime, meta.description\n        $ '.title', detail\n            .text meta.description.title\n\n        $ '.description', detail\n            .text meta.description.description\n\n        $ '.size', detail\n            .text bytesToSize(meta.description.size, 2)\n\n        $ \"form[data-control=\\\"publish\\\"]\", detail\n            .prop 'action', \"/admin/inoplate-media/libraries/publish/#{meta.id}\"\n\n        $ \"form[data-control=\\\"unpublish\\\"]\", detail\n            .prop 'action', \"/admin/inoplate-media/libraries/unpublish/#{meta.id}\"\n\n        $ \"form[data-control=\\\"removal\\\"]\", detail\n            .prop 'action', \"/admin/inoplate-media/libraries/#{meta.id}\"\n\n        $ \"a.dl-link\", detail\n            .prop \"href\", \"download/#{meta.description.path}\"\n\n        $ 'input[name=\"title\"]', '#library-update-form'\n            .val meta.description.title\n\n        $ 'textarea[name=\"description\"]', '#library-update-form'\n            .val meta.description.description\n\n        $ \"form[data-control=\\\"general-form\\\"]\", '#library-update-form'\n            .prop 'action', \"/admin/inoplate-media/libraries/#{meta.id}\"\n\n        $ \"form[data-control=\\\"sharing\\\"]\", '#sharing-form'\n            .prop 'action', \"/admin/inoplate-media/libraries/share/#{meta.id}\"\n\n        $ \"select[name=\\\"users\\\"]\", \"form[data-control=\\\"sharing\\\"]\"\n            .data \"source\", \"/admin/inoplate-media/libraries/shareable-users/#{meta.id}\"\n\n        sharingTable.clear()\n        sharingTable.row.add( [author.id, author.description.name, null] ) for author in meta.sharedTo\n        sharingTable.draw()\n\n        if meta.description.updateable\n            $ \"#btn-update\"\n                .removeClass 'disabled'\n        else\n            $ \"#btn-update\"\n                .addClass 'disabled'\n\n        if meta.description.shareable\n            $ \"#btn-share\"\n                .removeClass 'disabled'\n        else\n            $ \"#btn-share\"\n                .addClass 'disabled'\n\n        if meta.description.deletable\n            $ \"form[data-control=\\\"removal\\\"]\", detail\n                .removeClass 'hide'\n        else\n            $ \"form[data-control=\\\"removal\\\"]\", detail\n                .addClass 'hide'\n\n        if meta.description.publishable\n\n            if meta.description.visibility == 'private'\n                $ \"form[data-control=\\\"publish\\\"]\", detail\n                    .removeClass 'hide'\n                $ \"form[data-control=\\\"unpublish\\\"]\", detail\n                    .addClass 'hide'\n            else\n                $ \"form[data-control=\\\"publish\\\"]\", detail\n                    .addClass 'hide'\n                $ \"form[data-control=\\\"unpublish\\\"]\", detail\n                    .removeClass 'hide'\n        else\n            $ \"form[data-control=\\\"publish\\\"]\", detail\n                .addClass 'hide'\n            $ \"form[data-control=\\\"unpublish\\\"]\", detail\n                .addClass 'hide'\n    else\n        detail.libraryDetail 'clearDetail'\n        detail.libraryDetail 'showError', error.file\n\n$ \"form[data-control=\\\"publish\\\"], form[data-control=\\\"unpublish\\\"]\"\n    .on 'ajax.form.success', (event, data, textStatus, jqXHR)->\n        $ \"form[data-control=\\\"publish\\\"]\"\n            .toggleClass 'hide'\n\n        $ \"form[data-control=\\\"unpublish\\\"]\"\n            .toggleClass 'hide'\n\n$ \"form[data-control=\\\"removal\\\"]\"\n    .on 'ajax.form.success', (event, data, textStatus, jqXHR)->\n        detail.libraryDetail 'clearDetail'\n        $ \"#library-#{data.library.id}\"\n            .remove()\n\n        tile.libraryTile 'checkPagination'\n\n        $ \"#btn-share\"\n            .addClass 'disabled'\n\n        $ \"#btn-update\"\n            .addClass 'disabled'\n\n$ \"form[data-control=\\\"sharing\\\"]\"\n    .on 'ajax.form.beforeSend', (e, jqXHR, settings) ->\n        sharingTableData = sharingTable.data()\n        authors = \"\"\n\n        sharingTableData.each (d) ->\n            authors = \"#{authors}authors[]=#{d[0]}\"\n\n        settings.data = \"#{settings.data}&#{authors}\"\n\n$ '#btn-update'\n    .on 'click', () ->\n        $ '#library-update-form'\n            .modal 'show'\n\n$ '#btn-share'\n    .on 'click', () ->\n        $ '#sharing-form'\n            .modal 'show'\n\n$ \"form[data-control=\\\"sharing\\\"], form[data-control=\\\"publish\\\"], form[data-control=\\\"unpublish\\\"], form[data-control=\\\"general-form\\\"]\"\n    .on 'ajax.form.success', (event, data, textStatus, jqXHR)->\n        $li = $ \"#library-#{data.library.id}\"\n        $li.data 'meta', data.library\n        $li.trigger 'media.library.tile.selected', data.library\n\n$ \"form[data-control=\\\"sharing\\\"]\"\n    .on 'ajax.form.success', (event, data, textStatus, jqXHR)->\n        $ '#sharing-form'\n            .modal 'hide'\n\n$ \"form[data-control=\\\"general-form\\\"]\"\n    .on 'ajax.form.success', (event, data, textStatus, jqXHR)->\n        $ '#library-update-form'\n            .modal 'hide'\n\n###$ \"#upload-new\"\n    .click () ->\n        $ '.uploader-container'\n            .toggleClass \"hide\"\n\n$ '.uploader'\n    .on 'uploader.fileAdded', (e, file) ->\n        $dom = $ \"<li class=\\\"uploading\\\" data-upload-id=\\\"#{file.uniqueIdentifier}\\\">\n                    <a class=\\\"thumbnail\\\">\n                        <div class=\\\"btn-action-wrapper\\\">\n                            <div class=\\\"btn-action\\\">\n                                <span class=\\\"fa-stack fa-lg btn-resume hide\\\">\n                                    <i class=\\\"fa fa-circle fa-stack-2x\\\"></i>\n                                    <i class=\\\"fa fa-repeat fa-stack-1x fa-inverse\\\"></i>\n                                </span>\n                                <span class=\\\"fa-stack fa-lg btn-pause\\\">\n                                    <i class=\\\"fa fa-circle fa-stack-2x\\\"></i>\n                                    <i class=\\\"fa fa-pause fa-stack-1x fa-inverse\\\"></i>\n                                </span>\n                                <span class=\\\"fa-stack fa-lg btn-cancel\\\">\n                                    <i class=\\\"fa fa-circle fa-stack-2x\\\"></i>\n                                    <i class=\\\"fa fa-times fa-stack-1x fa-inverse\\\"></i>\n                                </span>\n                            </div>\n                        </div>\n                        <img data-src=\\\"holder.js/150x150?text=Uploading..\\\" />\n                        <div class=\\\"caption\\\">#{file.name}</div>\n                    </a>\n                  </li>\"\n\n        $img = $ 'img', $dom\n\n        $ '.btn-pause', $dom\n            .on 'click', () ->\n                file.pause()\n                progress = file.progress() * 100\n                $img.attr\n                    'data-src': \"holder.js/150x150?text=(#{progress.toFixed(2)}%25)Paused\"\n                Holder.run\n                    images: $img[0]\n                $ this\n                    .addClass 'hide'\n\n                $ '.btn-resume', $dom\n                    .removeClass 'hide'\n\n        $ '.btn-resume', $dom\n            .on 'click', () ->\n                file.resume()\n                progress = file.progress() * 100\n                $img.attr\n                    'data-src': \"holder.js/150x150?text=(#{progress.toFixed(2)}%25)Uploading..\"\n                Holder.run\n                    images: $img[0]\n                $ this\n                    .addClass 'hide'\n\n                $ '.btn-pause', $dom\n                    .removeClass 'hide'\n\n        $ '.btn-cancel', $dom\n            .on 'click', () ->\n                file.cancel()\n                $dom.remove()\n\n        Holder.run\n            images: $img[0]\n\n        $ '.thumbnail-wrapper'\n            .prepend $dom\n\n$ '.uploader'\n    .on 'uploader.fileProgress', (e, file) ->\n        $img = $ 'img', \"[data-upload-id=\\\"#{file.uniqueIdentifier}\\\"]\"\n        $li = $ \"[data-upload-id=\\\"#{file.uniqueIdentifier}\\\"]\"\n        progress = file.progress() * 100\n        $img.attr\n            'data-src': \"holder.js/150x150?text=(#{progress.toFixed(2)}%25)Uploading..\"\n\n        Holder.run\n            images: $img[0]\n\n$ '.uploader'\n    .on 'uploader.fileRetry', (e, file, chunk) ->\n        $li = $ \"[data-upload-id=\\\"#{file.uniqueIdentifier}\\\"]\"\n        $li.removeClass 'error'\n        $li.addClass 'uploading'\n\n        $ '.btn-resume', $li\n            .click ()->\n                file.resume()\n\n                $ '.btn-pause', $li\n                    .removeClass 'hide'\n\n                $ this\n                    .addClass 'hide'\n\n$ '.uploader'\n    .on 'uploader.fileError', (e, file, message, chunk) ->\n        $img = $ 'img', \"[data-upload-id=\\\"#{file.uniqueIdentifier}\\\"]\"\n        $li = $ \"[data-upload-id=\\\"#{file.uniqueIdentifier}\\\"]\"\n\n        $img.attr\n            'data-src': \"holder.js/150x150?text=Error\"\n        \n        Holder.run\n            images: $img[0]\n\n        $li.removeClass 'uploading'\n            .addClass 'error'\n\n        $ '.btn-pause', $li\n            .addClass 'hide'\n\n        $ '.btn-resume', $li\n            .removeClass 'hide'\n\n        $ '.btn-resume', $li\n            .one 'click', ()->\n                file.retry()\n\n                $li.removeClass 'error'\n                    .addClass 'uploading'\n\n        $li.attr 'data-error-message', message\n\n$ '.uploader'\n    .on 'uploader.fileSuccess', (e, file, result) ->\n        result = JSON.parse result\n        library = result.library\n        thumbnail = getThumbnail(library.description.mime) || \"/uploads/#{library.description.path}/thumb\"\n\n        $ \"[data-upload-id=\\\"#{file.uniqueIdentifier}\\\"]\"\n            .removeClass 'uploading'\n\n        $ \"[data-upload-id=\\\"#{file.uniqueIdentifier}\\\"]\"\n            .data 'meta', result.library\n\n        $ \"img\", \"[data-upload-id=\\\"#{file.uniqueIdentifier}\\\"]\"\n            .prop 'src', thumbnail\n\n$ \"#toggle-media-detail\"\n    .click () ->\n        $ \".media-detail\"\n            .slideToggle 0, ()->\n                $ \".media-container\" \n                    .trigger 'scroll';\n        $ \"i\", this\n            .toggleClass \"fa-toggle-on fa-toggle-off\"\n\n$ \".uploader-dismiss\"\n    .click () ->\n        $ this\n            .parents \".uploader-container\"\n                .addClass \"hide\"\n\n$ \".media-container\"\n    .slimScroll\n        height: '450px'\n    .bind 'slimscrolling', (e, pos) ->\n        $pager = $ '.file-pager a'\n\n        if $pager.is(':within-viewport') && $pager.css('display') != 'none'\n            $ '.file-pager a'\n                .hide()\n\n            url = $ '.file-pager a'\n                        .prop 'href'\n\n            fetchMedias url\n\n$ \".media-detail-container .media-form\"\n    .slimScroll\n        height: '270px'\n\n$ \".slimScrollBar\"\n    .hide()\n\n$ \"ul.thumbnail-wrapper\"\n    .on \"click\", \"li\", () ->\n        uploading =  $ this\n                        .hasClass 'uploading'\n\n        if uploading\n            return false\n\n        parents = $ this\n                    .parents \"ul.thumbnail-wrapper\"\n\n        $ \"li\", parents\n            .removeClass \"selected\"\n\n        $ this\n            .addClass \"selected\"\n\n        meta = $ this\n                .data \"meta\"\n\n        error = $ this\n                    .data 'error-message'\n\n        if typeof meta == 'string'\n            meta = JSON.parse meta\n\n        if typeof error == 'string'\n            error = JSON.parse error\n\n        $ this\n            .trigger \"media.library.selected\", [meta, error]\n\n$ \"ul.thumbnail-wrapper\"\n    .on \"media.library.selected\", \"li\", (event, meta, error) ->\n        $ \".media-full-preview\"\n            .removeClass \"no-border\"\n\n$ \"ul.thumbnail-wrapper\"\n    .on \"media.library.selected\", \"li.error\", (event, meta, error) ->\n        $li = $ this\n        $ \".media-action-btn\"\n            .addClass \"hide\"\n\n        $ \".media-preview-container\"\n            .addClass \"hide\"\n\n        $ \".media-form\"\n            .addClass \"hide\"\n\n        error = error.file\n        parsed = ''\n\n        if $.isArray(error)\n            $.each error, (key, value) ->\n                parsed += \"<li>#{value}</li>\"\n        else\n            parsed = \"<li>#{error}</li>\"\n\n        $ '.media-error ul'\n            .html parsed\n\n        $ '.media-error'\n            .removeClass 'hide'\n\n$ \"ul.thumbnail-wrapper\"\n    .on \"media.library.selected\", \"li:not('.error')\", (event, meta, error) ->\n        $ '.media-error'\n            .addClass 'hide'\n\n        mime = meta.description.mime\n\n        preview = ''\n\n        if isImage(mime)\n            preview = \"<a class=\\\"fancybox fancybox.image\\\" \n                          href=\\\"uploads/#{meta.description.path}/full-display\\\"\n                          title=\\\"uploads/#{meta.description.title}\\\"\n                        >\n                            <img src=\\\"uploads/#{meta.description.path}/mini-display\\\" \n                                 alt=\\\"#{meta.description.title}\\\" \n                            />\n                       </a>\"\n\n        else if isVideo(mime)\n            preview = \"<video width=\\\"300\\\" height=\\\"225\\\">\n                            <source type=\\\"#{mime}\\\" src=\\\"uploads/#{meta.description.path}\\\" />\n                        </video>\"\n        else if isAudio(mime)\n            preview = \"<audio width=\\\"300\\\">\n                            <source type=\\\"#{mime}\\\" src=\\\"uploads/#{meta.description.path}\\\" />\n                        </audio>\"\n        else \n            thumbnail = getThumbnail(mime)\n            preview = \"<img src=\\\"#{thumbnail}\\\" alt=\\\"#{meta.description.title}\\\" />\"\n\n        $ \".media-full-preview\"\n            .html preview\n\n        $ 'audio, video', '.media-full-preview'\n            .mediaelementplayer\n                pluginPath: ''\n                enablePluginDebug: false\n                enableAutosize: true\n                enableKeyboard: true\n                features: ['playpause','progress','current','duration','tracks','volume','backlight']\n                timerRate: 250\n                success: (media, node, player) ->\n                    $ \"##{node.id}-mode\"\n                        .html \"mode: #{media.pluginType}\"\n\n        $ \".media-action-btn\"\n            .removeClass \"hide\"\n\n        $ \".media-preview-container\"\n            .removeClass \"hide\"\n\n        $ \".media-form\"\n            .removeClass \"hide\"\n\n        $ 'input[name=\"title\"]', '.media-form'\n            .val meta.description.title\n\n        $ 'span.title'\n            .text meta.description.title\n\n        $ 'textarea[name=\"description\"]', '.media-form'\n            .val meta.description.description\n\n        $ 'span.description'\n            .text meta.description.description\n\n        if meta.description.updateable\n            $ \"[data-control=\\\"information\\\"]\"\n                .addClass 'hide'\n            $ \"[data-control=\\\"general-form\\\"]\"\n                .removeClass 'hide'\n        else\n            $ \"[data-control=\\\"information\\\"]\"\n                .removeClass 'hide'\n            $ \"[data-control=\\\"general-form\\\"]\"\n                .addClass 'hide'\n\n        if meta.description.shareable\n            $ \"[data-control=\\\"sharing\\\"]\"\n                .removeClass 'hide'\n        else\n            $ \"[data-control=\\\"sharing\\\"]\"\n                .addClass 'hide'\n\n        if meta.description.publishable\n\n            if !meta.description.visibility\n                $ \"form[data-control=\\\"publish\\\"]\"\n                    .removeClass 'hide'\n                $ \"form[data-control=\\\"unpublish\\\"]\"\n                    .addClass 'hide'\n            else\n                $ \"form[data-control=\\\"publish\\\"]\"\n                    .addClass 'hide'\n                $ \"form[data-control=\\\"unpublish\\\"]\"\n                    .removeClass 'hide'\n        else\n            $ \"form[data-control=\\\"publish\\\"]\"\n                .addClass 'hide'\n            $ \"form[data-control=\\\"unpublish\\\"]\"\n                .addClass 'hide'\n\n        if meta.description.deletable\n            $ \"form[data-control=\\\"removal\\\"]\"\n                .removeClass 'hide'\n        else\n            $ \"form[data-control=\\\"removal\\\"]\"\n                .addClass 'hide'\n\n        $ \"form[data-control=\\\"general-form\\\"]\"\n            .prop 'action', \"/admin/inoplate-media/libraries/#{meta.id}\"\n\n        $ \"form[data-control=\\\"sharing\\\"]\"\n            .prop 'action', \"/admin/inoplate-media/libraries/share/#{meta.id}\"\n\n        $ \"select[name=\\\"users[]\\\"]\", \"form[data-control=\\\"sharing\\\"]\"\n            .data \"source\", \"/admin/inoplate-media/libraries/shareable-users/#{meta.id}\"\n\n        $ \"form[data-control=\\\"publish\\\"]\"\n            .prop 'action', \"/admin/inoplate-media/libraries/publish/#{meta.id}\"\n\n        $ \"form[data-control=\\\"unpublish\\\"]\"\n            .prop 'action', \"/admin/inoplate-media/libraries/unpublish/#{meta.id}\"\n\n        $ \"form[data-control=\\\"removal\\\"]\"\n            .prop 'action', \"/admin/inoplate-media/libraries/#{meta.id}\"\n\n        $ \"a.dl-link\", \".media-action-btn\"\n            .prop \"href\", \"download/#{meta.description.path}\"\n\n        $ \"a.fancybox\", \".media-full-preview\"\n            .fancybox()\n\n        authors = (new Option(author.description.name, author.id, true, true) for author in meta.sharedTo)\n\n        $ \"select[name=\\\"users[]\\\"]\", \"form[data-control=\\\"sharing\\\"]\"\n            .html ''\n            .append authors\n            .trigger 'change.select2'\n\n$ \"ul.thumbnail-wrapper\"\n    .on 'media.library.reset-selected', (event) ->\n        $ '.media-error'\n            .addClass 'hide'\n\n        $ \".media-full-preview\"\n            .html \"<i class=\\\"fa fa-5x fa-eye-slash\\\" aria-hidden=\\\"true\\\"></i><p>Nothing is selected.</p>\"\n\n        $ \".media-full-preview\"\n            .addClass 'no-border'\n\n        $ \".media-action-btn\"\n            .addClass \"hide\"\n\n        $ \".media-form\"\n            .addClass \"hide\"\n\n        $ \"[data-control=\\\"information\\\"]\"\n            .addClass 'hide'\n\n        $ \"[data-control=\\\"general-form\\\"]\"\n            .addClass 'hide'\n\naddParams = () ->\n    ownership = $ 'select[name=\"ownership\"]'\n                    .val()\n\n    visibility = $ 'select[name=\"visibility\"]'\n                    .val()\n\n    search = $ 'input[name=\"search\"]'\n                .val()\n\n    return \"&ownership=#{ownership}&visibility=#{visibility}&search=#{search}\"\n\n\n$ '.btn-refresh'\n    .click () ->\n        $ '.thumbnail-wrapper'\n            .html ''\n\n        $ '.file-pager a'\n            .hide()\n\n        $ '.file-pager .end-info'\n            .addClass 'hide'\n\n        $ '.file-pager .overlay'\n            .removeClass 'hide'\n\n        $ \"ul.thumbnail-wrapper\"\n            .trigger \"media.library.reset-selected\"\n\n        fetchMedias '/admin/inoplate-media/libraries?page=1'\n\nparseItem = (item) ->\n    meta = JSON.stringify item\n    thumbnail = getThumbnail(item.description.mime) || \"/uploads/#{item.description.path}/thumb\"\n\n    $dom = $ \"<li id=\\\"library-#{item.id}\\\">\n                <a class=\\\"thumbnail\\\">\n                    <img class=\\\"lazy\\\" src=\\\"#{thumbnail}\\\" alt=\\\"#{item.description.title}\\\" />\n                    <div class=\\\"caption\\\">#{item.description.title}</div>\n                </a>\n              </li>\"\n\n    $dom.data 'meta', item\n\n    return $dom\n\nfetchMedias = (url) ->\n    $ '.file-pager .overlay'\n        .removeClass 'hide'\n\n    url += addParams()\n    items = []\n\n    $.get url, (result) ->\n\n        $ '.thumbnail-wrapper'\n            .append parseItem item for item in result.libraries.data\n\n        if result.libraries.next_page_url\n            $ '.file-pager a'\n                .prop 'href', result.libraries.next_page_url\n\n            $ '.file-pager a'\n                .show()\n        else\n            $ '.file-pager .end-info'\n                .removeClass 'hide'\n\n        $ '.file-pager .overlay'\n            .addClass 'hide'\n    ,\n        'json'\n\ngetThumbnail = (mime) ->\n    if isImage(mime)\n        return null\n\n    else if isVideo(mime)\n        return \"/vendor/inoplate-media/images/medias/video_128px.png\"\n\n    else if isAudio(mime)\n        return \"/vendor/inoplate-media/images/medias/music_128px.png\"\n\n    else if(mime == 'application/msword')\n        return \"/vendor/inoplate-media/images/medias/doc_128px.png\"\n\n    else if(mime == 'application/excel') || (mime == 'application/vnd.ms-excel') || (mime == 'application/x-excel') || (mime == 'application/x-msexcel')\n        return \"/vendor/inoplate-media/images/medias/xls_128px.png\"\n\n    else if(mime == 'application/mspowerpoint') || (mime == 'application/powerpoint') || (mime == 'application/vnd.ms-powerpoint') || (mime == 'application/x-mspowerpoint')\n        return \"/vendor/inoplate-media/images/medias/xls_128px.png\"\n\n    else\n        return \"/vendor/inoplate-media/images/medias/file_128px.png\"\n\nisImage = (mime) ->\n    if(mime.substring(0,5) == 'image')\n        return true\n\n    return false\n\nisVideo = (mime) ->\n    if(mime.substring(0,5) == 'video')\n        return true\n\n    return false\n\nisAudio = (mime) ->\n    if(mime.substring(0,5) == 'audio')\n        return true\n\n    return false\n\nuserFormatRepo = (repo) ->\n  if (repo.loading) \n    return repo.text;\n\n  markup = \"<div class='select2-result-repository clearfix'>\n                <div class='select2-result-repository__meta'>\n                  <div class='select2-result-repository__title'>#{repo.name}</div>\n                </div>\n            </div>\";\n\n  return markup;\n\nuserFormatRepoSelection = (repo) ->\n  return repo.name||repo.text;\n\n$ \"select[name='users[]']\"\n    .select2\n        ajax:\n            url: () ->\n                source = $ \"select[name=\\\"users[]\\\"]\", \"form[data-control=\\\"sharing\\\"]\"\n                            .data \"source\"\n\n                source\n            ,\n            dataType: 'json'\n            ,\n            delay: 250\n            ,\n            data: (params) ->\n                param =\n                    search: params.term\n                    page: params.page\n\n                param\n            ,\n            processResults: (data, params) ->\n                params.page = params.page || 1;\n\n                results = \n                    results: data.data\n                    pagination:\n                        more: (params.page * 5) < data.total\n\n                results\n            ,\n        escapeMarkup: (markup) -> \n            return markup\n            \n        minimumInputLength: 1\n        templateResult: userFormatRepo\n        templateSelection: userFormatRepoSelection\n\n$ \"form[data-control=\\\"sharing\\\"], form[data-control=\\\"publish\\\"], form[data-control=\\\"unpublish\\\"], form[data-control=\\\"general-form\\\"]\"\n    .on 'ajax.form.success', (event, data, textStatus, jqXHR)->\n        $ \"#library-#{data.library.id}\"\n            .data 'meta', data.library\n\n$ \"form[data-control=\\\"publish\\\"], form[data-control=\\\"unpublish\\\"]\"\n    .on 'ajax.form.success', (event, data, textStatus, jqXHR)->\n        $ \"form[data-control=\\\"publish\\\"]\"\n            .toggleClass 'hide'\n\n        $ \"form[data-control=\\\"unpublish\\\"]\"\n            .toggleClass 'hide'\n\n$ \"form[data-control=\\\"removal\\\"]\"\n    .on 'ajax.form.success', (event, data, textStatus, jqXHR)->\n        $ \"#library-#{data.library.id}\"\n            .parents 'ul.thumbnail-wrapper'\n            .trigger 'media.library.reset-selected'\n\n        $ \"#library-#{data.library.id}\"\n            .remove()\n\n        if $('.file-pager a').is(\":visible\")\n            $ '.file-pager a'\n                .hide()\n\n            url = $ '.file-pager a'\n                    .prop 'href'\n\n            fetchMedias url###"],"sourceRoot":"/source/"}